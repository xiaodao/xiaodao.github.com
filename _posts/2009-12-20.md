---
layout: post
title: 学而时习之
category: 朝花夕拾
tags: []
---

	回顾一下昨天的工作。从可以观察的度量项上来比较一下重构前后的代码，圈复杂度从5到2，方法的平均代码行数从6变成不到3。所做的事情主要是以下几点：

	1. 解耦合。原来是很多操作都放在一个丑陋的downloader对象来做，其他对象都是贫血模型而已；改成了每种类型的页面对象负责下载自己对应的页面并解析，构造下一级的页面对象。把对象的职责理顺以后，代码看起来就舒服多了。

	2. 方法提取。小方法更易理解，更易测试；从方法名就可以清楚的看到方法意图；而在方法提取的过程中，当我们发现方法越提取越多，也会被促使着思考这个类是不是承担了过多职责。

	做得比较好的地方是：小步快走，每一步都先重构或是补充测试代码，测试驱动重构。

	需要改进的地方：首先是不应该在犯困的时候写代码(-_-|||)；其次是在写代码之前没有先把需求想清楚，一上来就被细节陷进去了，也没有个设计思路，盲目的开始写，正如被8x所批评过的一样。这个错误也很严重的影响了重构，所以解耦合的时候步履维艰。