---
layout: post
title: 开源项目iRefactoring简介
category: 敏捷开发
tags: [可视化管理, irefactoring, opensource, refactoring]
---
每个项目都有可能出现遗留代码，或早或晚。每个类都有可能是个很大的坑，动一动就会不小心掉进去。于是人们常说：如果它还能工作，或者是不怎么需要改动，那就先不碰它。

但墨菲定律总是会起作用的。那些避之唯恐不急的类，总是令人惊恐的出现在我们面前。这里要做hot fix，那里要加一个新功能──而且时间总是很短，短的来不及读懂这陀逻辑，来不及做上一点点重构。

我们便不得不一边咬着牙恨恨骂着，“当初是谁写的这么烂的代码，等完事以后一定要好好重构一下”；一边给它加上一个if/else。但事情过后，我们往往就会安慰自己说，“这个类改起来太麻烦了，能用就行了，以后应该也不用动了。”可是还没等时间抹平心底的伤痕，这个类就又要改变……

因恐惧而产生的不切实际的期盼，在周而复始中支离破碎。

如果，如果有一些令人震撼的数据摆在眼前，是不是我们就再也没有逃避的空间，正视“必须动手重构”的事实？

但说句实话，市面上这种类型的开源项目很多，sonar、rcov、ncover……iRefactoring跟它们的区别在哪里？

其实，在“可视化管理”这项实践中，并不是所有的数据都能说话。有的数据只会告诉你项目中出现了问题，但不会告诉你问题出在那里，比如开发速度；有些数据会告诉你某个地方有问题，比如一个类的测试覆盖率低，圈复杂度高，可它还是死的，孤零零的摆在那里，看不到我们的开发工作会对这个数据造成哪些影响，不会有心理上的触动感。

而如果把代码的提交次数和圈复杂度/测试覆盖率结合起来呢？当看到一个提交127次，圈复杂度高达200的类，你会做何感想？如果你是一名PM，看到大量的提交造就了一个难以救药的对象，你会不会找人采取措施？如果你是一个developer，你还会不会在碰到这个类的时候继续抱有可改可不改的态度？

于是就有了<a href="https://github.com/xiaodao/iRefactoring">iRefactoring</a>这个工具，它可以根据代码的提交次数和圈复杂度/测试覆盖率生成报表。

比如看到下面这张图，你就可以知道右上角的类是那种提交次数又多，圈复杂度又高的，是系统中的毒瘤：

<img alt="" src="http://www.iamxiaodao.com/wp-content/uploads/2011/03/editor.png" title="code_analysis" class="alignnone" width="775" height="480">

欢迎大家<a href="https://github.com/xiaodao/iRefactoring">试用</a>并给出反馈。

Acknowledgement: 

The idea of iRefactoring is based on the article of Micheal Feather: Getting Empirical about Refactoring