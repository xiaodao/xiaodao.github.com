---
layout: post
title: 运用系统思考，走上改善之路
category: 朝花夕拾
tags: 系统思考
---

(本文首发于[InfoQ中文站](http://www.infoq.com/cn/articles/lj-system-thinking-improvement-road))

为什么敏捷实施，或是任何一点的过程改进都步履维艰？即使是十几人的团队中，也会出现“写自动化测试”──“不写自动化测试”──“写自动化测试”──“不写自动化测试”这种循环往复的过程？

除了人们常常总结的“敏捷实施模式”，或是“敏捷失败经验分享”这样的具体话题之外，是不是还有一些存在于思维模式中的更加根本性的因素，阻碍了我们对系统全景的认知，从而导致改革先行者的黯然退场？

本文将通过两个案例来讲述如何使用系统思考，从全局掌握我们所处的复杂环境，做到既见树木，又见森林。

# 案例1：舍本逐末 #

有一个测试团队的负责人找到我们说，“我觉得现在的自动化测试问题很大，执行时间长，也不稳定，有的时候是测试写错了，也要花很长时间修。我打算组织一批人，重新设计一下测试代码的架构，把常用的底层功能封装成设计良好的API。”

我的同事说，“好啊，你们打算怎么做呢？”

他说，“我也还没想好，所以想过来商量一下。我希望这个东西做成以后，能够让不会写程序的QA们都能用它来写自动化测试脚本了，他们现在就是这样，又要做测试，又要学着写程序，我觉得太辛苦了。能让他们不用学编程就能写测试脚本就好了。”

“呃……要不我们先看一下现在的代码，了解一下都有什么问题，然后再讨论？”我内心有点小小的纠结。

“好吧，我来给你们开通访问权限，找人给你们讲代码”。他很爽快的答应了。

而后我看到了一屏一屏的重复代码，让人一阵阵的眩晕。两天之内，我仅仅用了“提取方法”这一个重构手法，就删掉了1200行代码。期间还发现，不知道谁在调试的时候把一处代码从等待3秒改成了等待10秒忘了改回来，于是其他人再复制粘贴的时候，就全变成了等待10秒。

事情就此清晰明朗。

依赖于一小拨人重新设计代码结构，提炼API，确实会在短期内使问题得到缓解。但使用这些API的人依然是那些不懂得如何编程的QA，他们依然会使用复制粘贴来解决问题。再好的架构、再优秀的设计，最终还是会淹没在大量重复的代码中，犹如黄金深埋浮沙之下。

而且如果问题表象得到暂时解决，人们就会缺少动力从根本上提升QA的编码能力，随着设计一点一点腐化，就又需要精兵强将充当救火队员。如此不断反复，直到有一天又回到重新设计乃至重写的老路上来。

这是个典型的“舍本逐末”的模型。

## 分析 ##

我们先引入《系统思考》中的两个基本概念，一个是同向连接，一个是反向连接。当变量A的变化能够引起变量B在同一个方向上的变化时，我们称A和B之间是同向连接，例如销售会影响收入，销售越多，收入越少，反之亦然。同向连接用下面的图例表示：

<img src="http://xiaodao.github.io/assets/images/s_connection.png" alt="">

当变量A的变化引起变量B在反方向变化时，我们称A和B之间是反向连接，例如草场上的兔子越多，草越少。反向连接用下面的图表示：

<img src="http://xiaodao.github.io/assets/images/o_connection.png" alt="">

现在回到案例场景中来，”测试代码质量低劣”这个变量会引发两种解决方案：一种是精兵强将解决，另一种是测试人员自己解决。质量越低，在解决方案上的投入就越大，这种投入反过来又会削弱代码质量不断下滑的趋势，从而让系统处于一种平衡状态。代码质量不会不断恶化下去，在解决方案上的投入也不会无限制增长。这种平衡状态被称作“调节环路”，在图中用天平表示。该环路会趋于平衡稳定。

<img src="http://xiaodao.github.io/assets/images/system_thinking_balancing_loop_basic.jpg" alt="">

这个图中有两个调节环路存在，无论选择哪一种方案，都会让系统倾向于保持稳定。但是，由精兵强将出马可以让问题症状迅速得到缓解，提升测试人员的编码能力则需要长期的辅导训练，不可能一蹴而就，所以图中的第二个调节环路实际上是有时间滞延存在的。

<img src="http://xiaodao.github.io/assets/images/system_thinking_balancing_loop_delay.jpg" alt="">

当系统中存在有滞延时，人们往往就会因为短期投入看不到效果而倾向于使用另外一种可以快速见效的解决方案，在我们的例子中就是由精兵强将解决问题。

与此同时，由精兵强将解决问题会减少测试人员锻炼的机会，从而削弱测试人员的编码能力，进一步使人们不倾向于让测试人员自己解决问题，又转过头来增强了对于精兵强将的依赖。所以还要在图中增加另外一条回路：

<img src="http://xiaodao.github.io/assets/images/system_thinking_shifting_the_burden.jpg" alt="">

滚雪球表示增强环路，该回路会使得回路上的所有节点持续增强。

这幅图的全貌便构成了“舍本逐末”的模型。彼得·圣吉在《第五项修炼》中对此解释到：

>上面的环路代表快速见效的症状解，它迅速解决问题症状，但只是暂时的。下面的环路包含了时间延滞，它代表较根本的解决方案，但其效果要较长的时间才会显现出来。然而它可能是惟一持久见效的方式。有时候舍本逐末的结构中，会多出一个由症状解所带来的副作用所形成的增强环路。发生这样的情形时，副作用常使问题更难以解决。

人们或者是因为没有找到问题的根源，或者是因为时间延滞的存在，倾向于采取一种简单易行又可以立竿见影的方案，这便是症状解了。症状消除以后，问题就不再令人重视，从而丧失了从根本上解决问题的能力。而问题依然深藏，等到它有一天再度浮上水面时，症状就会更重，更难解决。

这是一条不断衰减的增强环路。在回路上每走一步，情况就会更恶劣一分。

## 小结 ##

面对“舍本逐末”，通常的解决方案有两条：

* 必须要认识到症状解只是短期止痛的手段，切不能形成依赖；
* 在症状得到缓解之后，要继续加强对根本解的重视。

但见招拆招总是相对容易一些的，更关键的地方是，如何才能识别出“舍本逐末”这样的模型？当我们采取某些理所当然的对策却得到了不合理的结果，有什么办法可以帮助我们分析问题根源，找到解决方案？

要认清问题的本质，就必须要认识到，我们所处的是各个因素之间紧密连接相互影响的复杂系统，当前采取的行动，会从多方面对这个系统产生影响，而这些影响之间或推波助澜，或相互牵制，从而导致相同的行动在长期和短期来看具有不同的结果。

比如，当代码中发现bug的时候，很多人的常见反应都是“调试──定位──解决”这样的思路。从眼前来看，发现bug立即修复是可以最快见效的手段，但却丧失了将测试进行完善的机会，相当于是安全网上明明出现了漏洞却听之任之。等到以后因为需求变更等原因影响了这块代码的时候，就再也无法通过执行测试来得到快速而完整的反馈了。

丹尼斯·舍伍德在《系统思考》中说，

>如果你希望了解一个系统，并进而能够预测它的行为，那么，就非常有必要将系统作为一个整体来研究。将系统各部分割裂开来研究，很可能破坏系统内部的连接，从而破坏系统本身。

>如果你希望影响或控制系统的行为，你必须将系统作为一个整体来采取行动。在某些地方采取行动并希望其他地方不受影响的想法注定要失败──这也就是连接的意义所在。

为了帮助人们更好的从整体上研究复杂系统的行为，丹尼斯在书中提供了一套完整的工具──系统循环图。

系统循环图中共有三个基本要素：

* 增强环路。在增强环路中共有偶数个O型连接，增强环路上的各个节点会呈现指数增长或指数衰退。
* 调节环路。在调节环路上共有奇数个O型连接，调节环路上的各个节点会趋于平衡状态。它会消化掉外界的影响力，使改变难以发生。
* 时间滞延。时间滞延是一个不容忽视的影响力，由于滞延的存在，人们常常会发现某个行为在短期内没有产生预想的结果，从而加大投入力度，当行为的后果出现在眼前时，却已经矫枉过正。

在下一篇文章中，我将通过另一个真实的案例来讲述“系统循环图”的应用。